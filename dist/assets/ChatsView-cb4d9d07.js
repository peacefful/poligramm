import{l as E,s as k,d as L,k as f,m as z,n as H,r as h,q as F,x as O,y as q,u as s,c as r,a as u,t as x,b as m,U,z as G,A as P,B as J,F as K,C as Q,D as W,E as X,o as d,G as Y,H as Z}from"./index-f7f9da29.js";const ee="/assets/chat-810ec4a5.svg",te="/assets/trash-00570b08.svg";let p;const se=new Uint8Array(16);function ne(){if(!p&&(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(se)}const n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function oe(e,t=0){return n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]}const ae=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),b={randomUUID:ae};function le(e,t,i){if(b.randomUUID&&!t&&!e)return b.randomUUID();e=e||{};const o=e.random||(e.rng||ne)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){i=i||0;for(let l=0;l<16;++l)t[i+l]=o[l];return t}return oe(o)}const g="https://srv.poligramm.kz/api/chats",y=E.create({baseURL:g});y.defaults.headers.common.Authorization=k.getData("token");const ie=async e=>{e.trim()&&(await y.post(g,{roomName:e,uuid:le(),userId:Number(k.getData("id"))}),e="",location.reload())},ue=async e=>{try{await y.delete(`${g}/${e}`),location.reload()}catch(t){console.log(t)}},ce={class:"text-center text-3xl mt-2"},de={class:"m-2"},re={class:"flex items-center mt-3 justify-between flex-wrap"},me={key:0},pe={class:"bg-blue-500 p-5 rounded-md flex justify-between items-center mt-2"},he={class:"flex w-20 justify-between"},ge=["title","onClick"],ye=["title","onClick"],_e={key:1,class:"mt-6"},xe=L({__name:"ChatsView",setup(e){const{t}=f({useScope:"global"}),i=z();H(async()=>await i.getUserData());const o=h(""),l=h(""),{body:w,isOpenMenu:M,toogleMenu:I}=F(),{openModal:D,closeModal:N,isOpenModal:S}=O(),{enterChat:V,closeChat:T,showChats:$,uuid:A,room:B}=q(),R=h([{title:t("createChat"),onClick:D}]);return(ve,c)=>{var _,v,C;return s($)===!0?(d(),r("div",{key:0,ref_key:"body",ref:w,class:"min-h-screen overflow-x-hidden"},[u("h1",ce,x(s(t)("chatsList")),1),u("div",de,[u("div",re,[m(U,{class:"p-2",bg:"#0054A8",value:l.value,"onUpdate:value":c[0]||(c[0]=a=>l.value=a)},null,8,["value"]),m(G,{"is-open-menu":s(M),onToogleMenu:s(I),menu:R.value},null,8,["is-open-menu","onToogleMenu","menu"]),m(J,{onSubmitModal:c[2]||(c[2]=a=>s(ie)(o.value)),onCloseModal:s(N),"is-open-modal":s(S),title:"Заполните поля","title-success-button":s(t)("create")},{default:P(()=>[m(U,{class:"p-3",value:o.value,"onUpdate:value":c[1]||(c[1]=a=>o.value=a),placeholder:s(t)("chatName")},null,8,["value","placeholder"])]),_:1},8,["onCloseModal","is-open-modal","title-success-button"])]),(C=(v=(_=s(i))==null?void 0:_.user)==null?void 0:v.chats)!=null&&C.length?(d(),r("div",me,[(d(!0),r(K,null,Q(s(Z)(s(i).user.chats,l.value),a=>(d(),r("ul",{class:"mt-4",key:a.id},[u("li",pe,[Y(x(a.roomName)+" ",1),u("div",he,[u("img",{title:s(t)("goChat"),onClick:j=>s(V)(a.uuid,a.roomName),src:ee},null,8,ge),u("img",{title:s(t)("delete"),onClick:j=>s(ue)(a.id),src:te},null,8,ye)])])]))),128))])):(d(),r("div",_e,"Чатов пока нет."))])],512)):(d(),W(X,{key:1,onCloseChat:s(T),uuid:s(A),name:s(B)},null,8,["onCloseChat","uuid","name"]))}}});export{xe as default};
