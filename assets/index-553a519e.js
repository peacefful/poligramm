import{a as V,h as w,b as _,s as A,d as b,C as T,p as E,c as F,A as N,u as $,e as U,r as B,f as v,g as D,i as I,j as L,o,k,w as c,l as n,m as s,n as m,_ as j,q as g,t as p,v as z,x,F as H,S as O,y as R}from"./index-42c5f00f.js";import{u as q,_ as S,F as J}from"./Form-0c2f3e56.js";const{Axios:te,AxiosError:P,CanceledError:ae,isCancel:oe,CancelToken:ne,VERSION:re,all:ie,Cancel:ce,isAxiosError:le,spread:ue,toFormData:de,AxiosHeaders:_e,HttpStatusCode:pe,formToJSON:me,getAdapter:ge,mergeConfig:he}=V,G=async l=>{try{const e=(await w.post("/api/users/auth",{...l})).data;return e&&(_.set("accessToken",e.accessToken),_.set("refreshToken",e.refreshToken),_.set("uuid",e.uuid),A.setData("id",e.id)),e}catch(e){return e}},K={class:"mt"},M={key:0},Q={key:1},W=b({__name:"LoginForm",setup(l){T.register(E,F,N);const e=$(),{t:r}=U({useScope:"global"}),a=B({login:"",password:""}),h=v(!1),f=v(0),{handleSubmit:y}=q({validationSchema:D({...I})}),C=y(async()=>{var t;const i=await G(a);if(!(i instanceof P)&&i.accessToken)e.push("/chats");else{h.value=!0;const u=i;f.value=(t=u.response)==null?void 0:t.status}});return(i,t)=>{const u=L("router-link");return o(),k(s(J),{title:"authorization","button-title":"signIn","handler-submit":s(C)},{labels:c(()=>[n(s(S),{name:"login",class:"vee-input","error-name":"incorrectesLogin",modelValue:a.login,"onUpdate:modelValue":t[0]||(t[0]=d=>a.login=d)},null,8,["modelValue"]),m("div",K,[n(s(S),{name:"password",type:"password",class:"vee-input","error-name":"incorrectesPassword",modelValue:a.password,"onUpdate:modelValue":t[1]||(t[1]=d=>a.password=d)},null,8,["modelValue"])]),h.value?(o(),k(s(j),{key:0,"type-toast":"error"},{default:c(()=>[f.value===404?(o(),g("div",M,p(s(r)("notAccount",2)),1)):(o(),g("div",Q,"Не правильный логин или пароль"))]),_:1})):z("",!0)]),hint:c(()=>[x(p(s(r)("notAccount"))+" ",1),n(u,{class:"underline",to:"/signup"},{default:c(()=>[x(p(s(r)("signUp",2)),1)]),_:1})]),_:1},8,["handler-submit"])}}}),X={class:"signin"},Y={class:"hidden sm:block"},Z=b({__name:"Signin",setup(l){return(e,r)=>(o(),g(H,null,[m("div",X,[n(s(W))]),m("div",Y,[n(s(O),{class:"flex justify-end mr-4"})])],64))}});const fe=R(Z,[["__scopeId","data-v-9b3bc7ea"]]);export{fe as default};
